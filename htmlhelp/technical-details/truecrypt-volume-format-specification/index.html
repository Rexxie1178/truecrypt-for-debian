<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>TrueCrypt Volume Format Specification - Truecrypt</title>
<link rel='stylesheet' id='wp-block-library-group-css' href='../../wp-content/plugins/bwp-minify/cache/minify-b1-wp-block-library-b4bc22b6e85c5b4ad13ac5538241afe6592e.css?ver=3' type='text/css' media='all'>
</head>
<body class="page-template">
<div class="container">
<div class="row">
<div class="col-sm-8 blog-main-right">
<div class="blog-post">
<h2 class="blog-post-title">TrueCrypt Volume Format Specification</h2>
<p class="blog-post-meta"><br></p>
<div class="entry clearfix">
<table class="table table-bordered table-striped" border="1" cellspacing="0">
<tbody>
<tr>
<td>Offset<br>
(bytes)</td>
<td>Size<br>
(bytes)</td>
<td>Encryption<br>
Status<span class="s55">^</span></td>
<td>Description</td>
</tr>
<tr>
<td>
<p class="s54">0</p>
<p>64</p>
<p>68</p>
<p>70</p>
<p>72</p>
<p>76</p>
<p>92</p>
<p>100</p>
<p>108</p>
<p>116</p>
<p>124</p>
<p>128</p>
<p>132</p>
<p>252</p>
<p>256</p>
<p>512</p>
<p>65536</p>
<p>131072</p>
<p>S–<span class="s54">131072</span><span class="s55">†</span></p>
<p>S–<span class="s54">65536</span></p>
</td>
<td>
<p class="s54">64</p>
<p>4</p>
<p>2</p>
<p>2</p>
<p>4</p>
<p>16</p>
<p>8</p>
<p>8</p>
<p>8</p>
<p>8</p>
<p>4</p>
<p>4</p>
<p>120</p>
<p>4</p>
<p>Var.</p>
<p>65024</p>
<p>65536</p>
<p>Var.</p>
<p>65536</p>
<p>65536</p>
</td>
<td>
<p class="s54">Unencrypted‡</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted</p>
<p>Encrypted / Unencrypted<span class="s55">‡</span></p>
<p>Encrypted</p>
<p>Encrypted / Unencrypted<span class="s55">‡</span></p>
<p>Encrypted / Unencrypted<span class="s55">‡</span></p>
</td>
<td>
<p class="s54">Salt</p>
<p>ASCII string “TRUE”</p>
<p>Volume header format version (5)</p>
<p>Minimum program version required to open the volume</p>
<p>CRC-32 checksum of the (decrypted) bytes 256–511</p>
<p>Reserved (must contain zeroes)</p>
<p>Size of hidden volume (set to zero in non-hidden volumes)</p>
<p>Size of volume</p>
<p>Byte offset of the start of the master key scope</p>
<p>Size of the encrypted area within the master key scope</p>
<p>Flag bits (bit 0 set: system encryption; bit 1 set: non-system in-place-encrypted volume; bits 2-31 are reserved)</p>
<p>Sector size (in bytes)</p>
<p>Reserved (must contain zeroes)</p>
<p>CRC-32 checksum of the (decrypted) bytes 64–251</p>
<p>Concatenated primary and secondary master keys<span class="s55">§</span></p>
<p>Reserved (for system encryption, this item is omitted<span class="s55">††</span>)</p>
<p>Area for hidden volume header (if there is no hidden volume within the volume, this area contains random data<span class="s55">**</span>). For system encryption, this item is omitted.<span class="s55">††</span> See bytes 0–65535.</p>
<p>Data area (master key scope). For system encryption, offset may be different (depending on offset of system partition).</p>
<p>Backup header (encrypted with a different header key derived using a different salt). For system encryption, this item is omitted. <span class="s55">††</span> See bytes 0–65535.</p>
<p>Backup header for hidden volume (encrypted with a different header key derived using a different salt). If there is no hidden volume within the volume, this area contains random data.<span class="s55">**</span> For system encryption, this item is omitted. <span class="s55">††</span> See bytes 0–65535.</p>
</td>
</tr>
</tbody>
</table>
<p class="s12">The fields located at byte #0 (salt) and #256 (master keys) contain random values generated by the random number generator (see the section <a href="../random-number-generator/index.html"><i>Random Number Generator</i></a>) during the volume creation process. If a TrueCrypt volume hosts a hidden volume (within its free space), the header of the hidden volume is located at byte #65536 of the host volume (the header of the host/outer volume is located at byte #0 of the host volume – see the section <a href="../../plausible-deniability/hidden-volume/index.html"><i>Hidden Volume</i></a>). If there is no hidden volume within a TrueCrypt volume, bytes 65536–131071 of the volume (i.e., the area where the header of a hidden volume can reside) contain random data (see above for information on the method used to fill free volume space with random data when the volume is created). The layout of the header of a hidden volume is the same as the one of a standard volume (bytes 0–65535).</p>
<p class="s12">The maximum possible TrueCrypt volume size is 2<span class="s49">63</span> bytes (8,589,934,592 GB). However, due to security reasons (with respect to the 128-bit block size used by the encryption algorithms), the maximum allowed volume size is 1 PB (1,048,576 GB).</p>
<h3>Embedded Backup Headers</h3>
<p class="s12">Each TrueCrypt volume created by TrueCrypt 6.0 or later contains an embedded backup header, located at the end of the volume (see above). The header backup is <i>not</i> a copy of the volume header because it is encrypted with a different header key derived using a different salt (see the section <a href="../header-key-derivation-salt-and-iteration-count/index.html"><i>Header Key Derivation, Salt, and Iteration Count</i></a>).</p>
<p class="s12">When the volume password and/or keyfiles are changed, or when the header is restored from the embedded (or an external) header backup, both the volume header and the backup header (embedded in the volume) are re-encrypted with different header keys (derived using newly generated salts – the salt for the volume header is different from the salt for the backup header). Each salt is generated by the TrueCrypt random number generator (see the section <a href="../random-number-generator/index.html"><i>Random Number Generator</i></a>).</p>
<p class="s12">For more information about header backups, see the subsection <i>Tools -&gt; Restore Volume Header</i> in the chapter <a href="../../main-program-window/index.html"><i>Main Program Window</i></a>.</p>
<p class="s19">* Provided that the options <i>Quick Format</i> and <i>Dynamic</i> are disabled and provided that the volume does not contain a filesystem that has been encrypted in place (note that TrueCrypt does not allow the user to create a hidden volume within such a volume).</p>
<p class="s19">^ The encrypted areas of the volume header are encrypted in XTS mode using the primary and secondary header keys. For more information, see the section <a href="../encryption-scheme/index.html"><i>Encryption Scheme</i></a> and the section <a href="../header-key-derivation-salt-and-iteration-count/index.html"><i>Header Key Derivation, Salt, and Iteration Count</i></a>.</p>
<p class="s19">† S denotes the size of the volume host (in bytes).</p>
<p class="s19">‡ Note that the salt does not need to be encrypted, as it does not have to be kept secret [7] (salt is a sequence of random values).</p>
<p class="s19">§ Multiple concatenated master keys are stored here when the volume is encrypted using a cascade of ciphers (secondary master keys are used for XTS mode).</p>
<p class="s19">** See above in this section for information on the method used to fill free volume space with random data when the volume is created.</p>
<p class="s19">†† Here, the meaning of “system encryption” does not include a hidden volume containing a hidden operating system. Note that this specification applies to volumes created by TrueCrypt 7.0 or later. The format of file- hosted volumes is identical to the format of partition/device-hosted volumes (however, the “volume header”, or key data, for a system partition/drive is stored in the last 512 bytes of the first logical drive track). TrueCrypt volumes have no “signature” or ID strings. Until decrypted, they appear to consist solely of random data. Free space on each TrueCrypt volume is filled with random data when the volume is created. * The random data is generated as follows: Right before TrueCrypt volume formatting begins, a temporary encryption key and a temporary secondary key (XTS mode) are generated by the random number generator (see the section <a href="../random-number-generator/index.html"><i>Random Number Generator</i></a>). The encryption algorithm that the user selected is initialized with the temporary keys. The encryption algorithm is then used to encrypt plaintext blocks consisting of zeroes. The encryption algorithm operates in XTS mode (see the section <a href="../modes-of-operation/index.html"><i>Modes of Operation</i></a>). The resulting ciphertext blocks are used to fill (overwrite) the free space on the volume. The temporary keys are stored in RAM and are erased after formatting finishes.</p>
</div>
</div>
</div>
<div class="col-sm-3 col-sm-offset-1 blog-sidebar-left">
<div id="search-4" class="sidebar-module widget widget_search"><br>
<br>
<br></div>
<div id="nav_menu-2" class="sidebar-module widget widget_nav_menu">
<div class="menu-documentation-container">
<ul id="menu-documentation" class="menu">
<li class="menu-item"><a href="../../index.html"><strong>Introduction</strong></a></li>
<li class="menu-item"><a href="../../beginners-tutorial/index.html"><strong>Beginner’s Tutorial</strong></a></li>
<li class="menu-item"><a href="../../system-encryption/index.html"><strong>System Encryption</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../system-encryption/operating-systems-supported-for-system-encryption/index.html">Supported Systems</a></li>
<li class="menu-item"><a href="../../system-encryption/hidden-operating-system/index.html">Hidden Operating System</a></li>
<li class="menu-item"><a href="../../system-encryption/truecrypt-rescue-disk/index.html">TrueCrypt Rescue Disk</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../plausible-deniability/index.html"><strong>Plausible Deniability</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../plausible-deniability/hidden-volume/index.html">Hidden Volume</a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../plausible-deniability/hidden-volume/protection-of-hidden-volumes-against-damage/index.html">Hidden Volume Protection</a></li>
<li class="menu-item"><a href="../../plausible-deniability/hidden-volume/security-requirements-and-precautions-pertaining-to-hidden-volumes/index.html">Security Requirements</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../plausible-deniability/hidden-operating-system/index.html">Hidden Operating System</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../parallelization/index.html"><strong>Parallelization</strong></a></li>
<li class="menu-item"><a href="../../pipelining/index.html"><strong>Pipelining</strong></a></li>
<li class="menu-item"><a href="../../hardware-acceleration/index.html"><strong>Hardware Acceleration</strong></a></li>
<li class="menu-item"><a href="../../encryption-algorithms/index.html"><strong>Encryption Algorithms</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../encryption-algorithms/aes/index.html">AES</a></li>
<li class="menu-item"><a href="../../encryption-algorithms/serpent/index.html">Serpent</a></li>
<li class="menu-item"><a href="../../encryption-algorithms/twofish/index.html">Twofish</a></li>
<li class="menu-item"><a href="../../encryption-algorithms/cascades/index.html">Cascades</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../hash-algorithms/index.html"><strong>Hash Algorithms</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../hash-algorithms/ripemd-160/index.html">RIPEMD-160</a></li>
<li class="menu-item"><a href="../../hash-algorithms/sha-512/index.html">SHA-512</a></li>
<li class="menu-item"><a href="../../hash-algorithms/whirlpool/index.html">Whirlpool</a></li>
</ul>
</li>
<li class="menu-item"><a href="../index.html"><strong>Technical Details</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../notation/index.html">Notation</a></li>
<li class="menu-item"><a href="../encryption-scheme/index.html">Encryption Scheme</a></li>
<li class="menu-item"><a href="../modes-of-operation/index.html">Modes of Operation</a></li>
<li class="menu-item"><a href="../header-key-derivation-salt-and-iteration-count/index.html">Header Key Derivation</a></li>
<li class="menu-item"><a href="../random-number-generator/index.html">Random Number Generator</a></li>
<li class="menu-item"><a href="../keyfiles/index.html">Keyfiles</a></li>
<li class="menu-item"><a href="index.html">Volume Format Specification</a></li>
<li class="menu-item"><a href="../compliance-with-standards-and-specifications/index.html">Standards and Specifications</a></li>
<li class="menu-item"><a href="../source-code/index.html">Source Code</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../truecrypt-volume/index.html"><strong>TrueCrypt Volume</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../truecrypt-volume/creating-a-new-truecrypt-volume/index.html">Creating a New TrueCrypt Volume</a></li>
<li class="menu-item"><a href="../../truecrypt-volume/favorite-volumes/index.html">Favorite Volumes</a></li>
<li class="menu-item"><a href="../../truecrypt-volume/system-favorite-volumes/index.html">System Favorite Volumes</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../main-program-window/index.html"><strong>Main Program Window</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../main-program-window/program-menu/index.html">Program Menu</a></li>
<li class="menu-item"><a href="../../main-program-window/mounting-truecrypt-volumes/index.html">Mounting TrueCrypt Volumes</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../supported-operating-systems/index.html"><strong>Supported Operating Systems</strong></a></li>
<li class="menu-item"><a href="../../portable-mode/index.html"><strong>Portable Mode</strong></a></li>
<li class="menu-item"><a href="../../keyfiles/index.html"><strong>Keyfiles</strong></a></li>
<li class="menu-item"><a href="../../security-tokens-smart-cards/index.html"><strong>Security Tokens & Smart Cards</strong></a></li>
<li class="menu-item"><a href="../../language-packs/index.html"><strong>Language Packs</strong></a></li>
<li class="menu-item"><a href="../../hot-keys/index.html"><strong>Hot Keys</strong></a></li>
<li class="menu-item"><a href="../../security-model/index.html"><strong>Security Model</strong></a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/index.html"><strong>Security Requirements</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/index.html">Data Leaks</a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/paging-file/index.html">Paging File</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/hibernation-file/index.html">Hibernation File</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/memory-dump-files/index.html">Memory Dump Files</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/unencrypted-data-in-ram/index.html">Unencrypted Data in RAM</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/physical-security/index.html">Physical Security</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/malware/index.html">Malware</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/multi-user-environment/index.html">Multi-User Environment</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/authenticity-and-integrity/index.html">Authenticity and Integrity</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/choosing-passwords-and-keyfiles/index.html">Choosing Passwords and Keyfiles</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/changing-passwords-and-keyfiles/index.html">Changing Passwords and Keyfiles</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/trim-operation/index.html">Trim Operation</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/wear-leveling/index.html">Wear-Leveling</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/reallocated-sectors/index.html">Reallocated Sectors</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/defragmenting/index.html">Defragmenting</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/journaling-file-systems/index.html">Journaling File Systems</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/volume-clones/index.html">Volume Clones</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/additional-security-requirements-and-precautions/index.html">Additional Security Requirements and Precautions</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../command-line-usage/index.html"><strong>Command Line Usage</strong></a></li>
<li class="menu-item"><a href="../../how-to-back-up-securely/index.html"><strong>How to Back Up Securely</strong></a></li>
<li class="menu-item"><a href="../../miscellaneous/index.html"><strong>Miscellaneous</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../miscellaneous/using-truecrypt-without-administrator-privileges/index.html">Using TrueCrypt Without Administrator Privileges</a></li>
<li class="menu-item"><a href="../../miscellaneous/sharing-over-network/index.html">Sharing over Network</a></li>
<li class="menu-item"><a href="../../miscellaneous/truecrypt-background-task/index.html">TrueCrypt Background Task</a></li>
<li class="menu-item"><a href="../../miscellaneous/volume-mounted-as-removable-medium/index.html">Volume Mounted as Removable Medium</a></li>
<li class="menu-item"><a href="../../miscellaneous/truecrypt-system-files-application-data/index.html">TrueCrypt System Files & Application Data</a></li>
<li class="menu-item"><a href="../../miscellaneous/how-to-remove-encryption/index.html">How to Remove Encryption</a></li>
<li class="menu-item"><a href="../../miscellaneous/uninstalling-truecrypt/index.html">Uninstalling TrueCrypt</a></li>
<li class="menu-item"><a href="../../miscellaneous/digital-signatures/index.html">Digital Signatures</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../troubleshooting/index.html"><strong>Troubleshooting</strong></a></li>
<li class="menu-item"><a href="../../frequently-asked-questions/index.html"><strong>Frequently Asked Questions</strong></a></li>
<li class="menu-item"><a href="../../incompatibilities/index.html"><strong>Incompatibilities</strong></a></li>
<li class="menu-item"><a href="../../known-issues-limitations/index.html"><strong>Known Issues & Limitations</strong></a></li>
<li class="menu-item"><a href="../../legal-information/index.html"><strong>Legal Information</strong></a></li>
<li class="menu-item"><a href="../../future-development/index.html"><strong>Future Development</strong></a></li>
<li class="menu-item"><a href="../../acknowledgements/index.html"><strong>Acknowledgements</strong></a></li>
<li class="menu-item"><a href="../../version-history/index.html"><strong>Version History</strong></a></li>
<li class="menu-item"><a href="../../references/index.html"><strong>References</strong></a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
