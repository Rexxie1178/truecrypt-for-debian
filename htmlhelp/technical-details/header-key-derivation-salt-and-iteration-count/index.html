<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Header Key Derivation, Salt, and Iteration Count - Truecrypt</title>
<link rel='stylesheet' id='wp-block-library-group-css' href='../../wp-content/plugins/bwp-minify/cache/minify-b1-wp-block-library-b4bc22b6e85c5b4ad13ac5538241afe6592e.css?ver=3' type='text/css' media='all'>
</head>
<body class="page-template">
<div class="container">
<div class="row">
<div class="col-sm-8 blog-main-right">
<div class="blog-post">
<h2 class="blog-post-title">Header Key Derivation, Salt, and Iteration Count</h2>
<p class="blog-post-meta"><br></p>
<div class="entry clearfix">
<p class="s12">Header key is used to encrypt and decrypt the encrypted area of the TrueCrypt volume header (for system encryption, of the key data area), which contains the master key and other data (see the sections <a href="../encryption-scheme/index.html"><i>Encryption Scheme</i></a> and <a href="../truecrypt-volume-format-specification/index.html"><i>TrueCrypt Volume Format Specification</i></a>). In volumes created by TrueCrypt 5.0 or later (and for system encryption), the area is encrypted in XTS mode (see the section <a href="../modes-of-operation/index.html"><i>Modes of Operation</i></a>). The method that TrueCrypt uses to generate the header key and the secondary header key (XTS mode) is PBKDF2, specified in PKCS #5 v2.0; see <a href="../../references/index.html"><i>References</i></a>.</p>
<p class="s12">512-bit salt is used, which means there are 2<span class="s49">512</span> keys for each password. This significantly decreases vulnerability to ‘off-line’ dictionary/’rainbow table’ attacks (pre-computing all the keys for a dictionary of passwords is very difficult when a salt is used) [7]. The salt consists of random values generated by the TrueCrypt random number generator during the volume creation process. The header key derivation function is based on HMAC-SHA-512, HMAC-RIPEMD-160, or HMAC- Whirlpool (see [8, 9, 20, 22]) – the user selects which. The length of the derived key does not depend on the size of the output of the underlying hash function. For example, a header key for the AES-256 cipher is always 256 bits long even if HMAC-RIPEMD-160 is used (in XTS mode, an additional 256-bit secondary header key is used; hence, two 256-bit keys are used for AES-256 in total). For more information, refer to [7]. 1000 iterations (or 2000 iterations when HMAC-RIPEMD-160 is used as the underlying hash function) of the key derivation function have to be performed to derive a header key, which increases the time necessary to perform an exhaustive search for passwords (i.e., brute force attack) [7].</p>
<p class="s12">Header keys used by ciphers in a cascade are mutually independent, even though they are derived from a single password (to which keyfiles may have been applied). For example, for the AES- Twofish-Serpent cascade, the header key derivation function is instructed to derive a 768-bit encryption key from a given password (and, for XTS mode, in addition, a 768-bit<i>secondary</i> header key from the given password). The generated 768-bit header key is then split into three 256-bit keys (for XTS mode, the <i>secondary</i> header key is split into three 256-bit keys too, so the cascade actually uses six 256-bit keys in total), out of which the first key is used by Serpent, the second key is used by Twofish, and the third by AES (in addition, for XTS mode, the first secondary key is used by Serpent, the second secondary key is used by Twofish, and the third secondary key by AES).</p>
<p class="s12">Hence, even when an adversary has one of the keys, he cannot use it to derive the other keys, as there is no feasible method to determine the password from which the key was derived (except for brute force attack mounted on a weak password).</p>
</div>
</div>
</div>
<div class="col-sm-3 col-sm-offset-1 blog-sidebar-left">
<div id="search-4" class="sidebar-module widget widget_search"><br>
<br>
<br></div>
<div id="nav_menu-2" class="sidebar-module widget widget_nav_menu">
<div class="menu-documentation-container">
<ul id="menu-documentation" class="menu">
<li class="menu-item"><a href="../../index.html"><strong>Introduction</strong></a></li>
<li class="menu-item"><a href="../../beginners-tutorial/index.html"><strong>Beginner’s Tutorial</strong></a></li>
<li class="menu-item"><a href="../../system-encryption/index.html"><strong>System Encryption</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../system-encryption/operating-systems-supported-for-system-encryption/index.html">Supported Systems</a></li>
<li class="menu-item"><a href="../../system-encryption/hidden-operating-system/index.html">Hidden Operating System</a></li>
<li class="menu-item"><a href="../../system-encryption/truecrypt-rescue-disk/index.html">TrueCrypt Rescue Disk</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../plausible-deniability/index.html"><strong>Plausible Deniability</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../plausible-deniability/hidden-volume/index.html">Hidden Volume</a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../plausible-deniability/hidden-volume/protection-of-hidden-volumes-against-damage/index.html">Hidden Volume Protection</a></li>
<li class="menu-item"><a href="../../plausible-deniability/hidden-volume/security-requirements-and-precautions-pertaining-to-hidden-volumes/index.html">Security Requirements</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../plausible-deniability/hidden-operating-system/index.html">Hidden Operating System</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../parallelization/index.html"><strong>Parallelization</strong></a></li>
<li class="menu-item"><a href="../../pipelining/index.html"><strong>Pipelining</strong></a></li>
<li class="menu-item"><a href="../../hardware-acceleration/index.html"><strong>Hardware Acceleration</strong></a></li>
<li class="menu-item"><a href="../../encryption-algorithms/index.html"><strong>Encryption Algorithms</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../encryption-algorithms/aes/index.html">AES</a></li>
<li class="menu-item"><a href="../../encryption-algorithms/serpent/index.html">Serpent</a></li>
<li class="menu-item"><a href="../../encryption-algorithms/twofish/index.html">Twofish</a></li>
<li class="menu-item"><a href="../../encryption-algorithms/cascades/index.html">Cascades</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../hash-algorithms/index.html"><strong>Hash Algorithms</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../hash-algorithms/ripemd-160/index.html">RIPEMD-160</a></li>
<li class="menu-item"><a href="../../hash-algorithms/sha-512/index.html">SHA-512</a></li>
<li class="menu-item"><a href="../../hash-algorithms/whirlpool/index.html">Whirlpool</a></li>
</ul>
</li>
<li class="menu-item"><a href="../index.html"><strong>Technical Details</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../notation/index.html">Notation</a></li>
<li class="menu-item"><a href="../encryption-scheme/index.html">Encryption Scheme</a></li>
<li class="menu-item"><a href="../modes-of-operation/index.html">Modes of Operation</a></li>
<li class="menu-item"><a href="index.html">Header Key Derivation</a></li>
<li class="menu-item"><a href="../random-number-generator/index.html">Random Number Generator</a></li>
<li class="menu-item"><a href="../keyfiles/index.html">Keyfiles</a></li>
<li class="menu-item"><a href="../truecrypt-volume-format-specification/index.html">Volume Format Specification</a></li>
<li class="menu-item"><a href="../compliance-with-standards-and-specifications/index.html">Standards and Specifications</a></li>
<li class="menu-item"><a href="../source-code/index.html">Source Code</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../truecrypt-volume/index.html"><strong>TrueCrypt Volume</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../truecrypt-volume/creating-a-new-truecrypt-volume/index.html">Creating a New TrueCrypt Volume</a></li>
<li class="menu-item"><a href="../../truecrypt-volume/favorite-volumes/index.html">Favorite Volumes</a></li>
<li class="menu-item"><a href="../../truecrypt-volume/system-favorite-volumes/index.html">System Favorite Volumes</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../main-program-window/index.html"><strong>Main Program Window</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../main-program-window/program-menu/index.html">Program Menu</a></li>
<li class="menu-item"><a href="../../main-program-window/mounting-truecrypt-volumes/index.html">Mounting TrueCrypt Volumes</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../supported-operating-systems/index.html"><strong>Supported Operating Systems</strong></a></li>
<li class="menu-item"><a href="../../portable-mode/index.html"><strong>Portable Mode</strong></a></li>
<li class="menu-item"><a href="../../keyfiles/index.html"><strong>Keyfiles</strong></a></li>
<li class="menu-item"><a href="../../security-tokens-smart-cards/index.html"><strong>Security Tokens & Smart Cards</strong></a></li>
<li class="menu-item"><a href="../../language-packs/index.html"><strong>Language Packs</strong></a></li>
<li class="menu-item"><a href="../../hot-keys/index.html"><strong>Hot Keys</strong></a></li>
<li class="menu-item"><a href="../../security-model/index.html"><strong>Security Model</strong></a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/index.html"><strong>Security Requirements</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/index.html">Data Leaks</a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/paging-file/index.html">Paging File</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/hibernation-file/index.html">Hibernation File</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/data-leaks/memory-dump-files/index.html">Memory Dump Files</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/unencrypted-data-in-ram/index.html">Unencrypted Data in RAM</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/physical-security/index.html">Physical Security</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/malware/index.html">Malware</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/multi-user-environment/index.html">Multi-User Environment</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/authenticity-and-integrity/index.html">Authenticity and Integrity</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/choosing-passwords-and-keyfiles/index.html">Choosing Passwords and Keyfiles</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/changing-passwords-and-keyfiles/index.html">Changing Passwords and Keyfiles</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/trim-operation/index.html">Trim Operation</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/wear-leveling/index.html">Wear-Leveling</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/reallocated-sectors/index.html">Reallocated Sectors</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/defragmenting/index.html">Defragmenting</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/journaling-file-systems/index.html">Journaling File Systems</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/volume-clones/index.html">Volume Clones</a></li>
<li class="menu-item"><a href="../../security-requirements-and-precautions/additional-security-requirements-and-precautions/index.html">Additional Security Requirements and Precautions</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../command-line-usage/index.html"><strong>Command Line Usage</strong></a></li>
<li class="menu-item"><a href="../../how-to-back-up-securely/index.html"><strong>How to Back Up Securely</strong></a></li>
<li class="menu-item"><a href="../../miscellaneous/index.html"><strong>Miscellaneous</strong></a>
<ul class="sub-menu">
<li class="menu-item"><a href="../../miscellaneous/using-truecrypt-without-administrator-privileges/index.html">Using TrueCrypt Without Administrator Privileges</a></li>
<li class="menu-item"><a href="../../miscellaneous/sharing-over-network/index.html">Sharing over Network</a></li>
<li class="menu-item"><a href="../../miscellaneous/truecrypt-background-task/index.html">TrueCrypt Background Task</a></li>
<li class="menu-item"><a href="../../miscellaneous/volume-mounted-as-removable-medium/index.html">Volume Mounted as Removable Medium</a></li>
<li class="menu-item"><a href="../../miscellaneous/truecrypt-system-files-application-data/index.html">TrueCrypt System Files & Application Data</a></li>
<li class="menu-item"><a href="../../miscellaneous/how-to-remove-encryption/index.html">How to Remove Encryption</a></li>
<li class="menu-item"><a href="../../miscellaneous/uninstalling-truecrypt/index.html">Uninstalling TrueCrypt</a></li>
<li class="menu-item"><a href="../../miscellaneous/digital-signatures/index.html">Digital Signatures</a></li>
</ul>
</li>
<li class="menu-item"><a href="../../troubleshooting/index.html"><strong>Troubleshooting</strong></a></li>
<li class="menu-item"><a href="../../frequently-asked-questions/index.html"><strong>Frequently Asked Questions</strong></a></li>
<li class="menu-item"><a href="../../incompatibilities/index.html"><strong>Incompatibilities</strong></a></li>
<li class="menu-item"><a href="../../known-issues-limitations/index.html"><strong>Known Issues & Limitations</strong></a></li>
<li class="menu-item"><a href="../../legal-information/index.html"><strong>Legal Information</strong></a></li>
<li class="menu-item"><a href="../../future-development/index.html"><strong>Future Development</strong></a></li>
<li class="menu-item"><a href="../../acknowledgements/index.html"><strong>Acknowledgements</strong></a></li>
<li class="menu-item"><a href="../../version-history/index.html"><strong>Version History</strong></a></li>
<li class="menu-item"><a href="../../references/index.html"><strong>References</strong></a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
